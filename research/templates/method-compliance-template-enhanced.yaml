# Enhanced Method Compliance Validation Template with Citation Integration
# This template tracks whether sub-agents properly followed research method prompts AND citation requirements
# CRITICAL INTEGRATION FIX #4: Citation compliance integrated into method validation

method_compliance_validation:
  session_id: "research_session_YYYYMMDD_HHMMSS"
  research_topic: "extracted_from_user_request"
  method_used: "method_name_from_orchestrator"
  validation_timestamp: "2024-07-04T10:00:00Z"
  citation_integration_version: "1.0.0"
  
  # CITATION COMPLIANCE VALIDATION (NEW)
  citation_compliance_validation:
    overall_citation_integrity:
      source_verification_accuracy: 0.0  # Percentage of sources successfully verified (target: ≥95%)
      citation_format_compliance: 0.0    # Percentage of citations meeting format standards (target: ≥98%)  
      attribution_completeness: 0.0      # Percentage of research with complete attribution (target: ≥98%)
      credibility_assessment_coverage: 0.0 # Percentage of sources with credibility assessment (target: ≥90%)
      independence_verification_rate: 0.0  # Percentage of sources with independence verification (target: ≥85%)
      conflict_resolution_effectiveness: 0.0 # Effectiveness of source conflict resolution (target: ≥90%)
      
    constitutional_ai_citation_integration:
      accuracy_principle_citation_support: false  # Citations adequately support accuracy principle
      objectivity_principle_source_diversity: false # Sources demonstrate diverse perspectives for objectivity  
      transparency_principle_methodology_documentation: false # Citation methodology transparently documented
      completeness_principle_comprehensive_sourcing: false # Comprehensive source coverage achieved
      responsibility_principle_credibility_assessment: false # Source credibility responsibly assessed
      integrity_principle_uncertainty_acknowledgment: false # Source limitations and uncertainty acknowledged
      
    real_time_validation_tracking:
      continuous_source_monitoring_implemented: false # Real-time source accessibility monitored
      progressive_credibility_assessment_applied: false # Credibility scores updated throughout research
      conflict_detection_during_execution: false # Conflicts detected and resolved during research
      attribution_chain_maintained: false # Attribution chains maintained throughout research execution
      
    source_coordination_effectiveness:
      primary_source_credibility_threshold_met: false # Primary sources meet credibility requirements
      supplementary_source_diversity_achieved: false # Supplementary sources provide adequate diversity
      validation_source_independence_verified: false # Validation sources are appropriately independent
      fallback_source_quality_maintained: false # Fallback sources maintain quality standards
      
  # Method-Specific Validation with Citation Enhancement
  method_validation:
    multi_perspective_approach:
      required_perspectives: 4
      expected_outputs:
        - "perspective-1-quantitative.md with statistical source validation"
        - "perspective-2-qualitative.md with expert source credibility assessment" 
        - "perspective-3-industry-practice.md with practitioner source verification"
        - "perspective-4-future-trends.md with trend analysis source triangulation"
        
      enhanced_validation_criteria:
        - "Each perspective has distinct expert persona with source specialization"
        - "Unique methodology for each perspective includes source validation approach"
        - "Different source priorities documented with credibility rationale"
        - "Complementary output formats include perspective-specific citation standards"
        - "Integration of all perspectives includes cross-perspective source validation"
        
      citation_enhanced_compliance_checks:
        perspective_count: 0  # Number of perspectives actually generated
        distinct_personas: false  # Whether each perspective has unique expert role + source specialization
        methodology_variance: false  # Whether methodologies differ + include source validation differences
        source_diversity: false  # Whether different source types used + cross-perspective independence verified
        integration_quality: 0.0  # Score 0-1 for perspective integration + cross-perspective citation validation
        perspective_citation_compliance: 0.0 # Overall citation compliance across all perspectives
    
    step_by_step_research:
      required_phases: 5
      expected_deliverables:
        - "Phase 1: Discovery & Scoping with source requirements identification"
        - "Phase 2: Broad Information Gathering with source credibility assessment"
        - "Phase 3: Deep Analysis with multi-source validation"
        - "Phase 4: Synthesis & Insights with comprehensive attribution"
        - "Phase 5: Validation & Documentation with citation integrity verification"
        
      enhanced_validation_criteria:
        - "Each phase completed with specific deliverables + citation requirements"
        - "Time estimates roughly followed + citation validation time included"
        - "Phase progression logic maintained + source validation continuity"
        - "Specific questions addressed at each stage + source verification conducted"
        
      citation_enhanced_compliance_checks:
        phases_completed: 0  # Number of phases actually completed
        deliverables_present: false  # Whether phase deliverables are documented + citation requirements met
        time_allocation_followed: false  # Whether phases took appropriate time + citation validation time
        progression_logic: false  # Whether phases built on each other + source validation progression
        phase_citation_compliance: 0.0 # Citation compliance across all phases
    
    primary_research:
      required_components: 5
      expected_structure:
        - "Role Definition: Specific expert persona with source specialization"
        - "Task Decomposition: 3-5 logical phases with source validation approach"
        - "Methodology Framework: Search strategies and criteria + credibility assessment"
        - "Output Specifications: Format and components + citation standards"
        - "Quality Metrics: Evaluation criteria + citation integrity requirements"
        
      enhanced_validation_criteria:
        - "Clear expert role definition with source specialization"
        - "Logical phase breakdown with source validation methodology"
        - "Specific methodology described + credibility assessment approach"
        - "Output format clearly specified + citation standards defined"
        - "Quality validation criteria included + citation integrity requirements"
        
      citation_enhanced_compliance_checks:
        role_definition_present: false # + source specialization included
        task_decomposition_clear: false # + source validation approach defined
        methodology_specified: false # + credibility assessment methodology included
        output_format_defined: false # + citation standards specified
        quality_metrics_included: false # + citation integrity requirements included
        primary_research_citation_compliance: 0.0 # Overall citation compliance for primary research
    
    constitutional_ai:
      required_phases: 6  
      expected_components:
        - "Constitutional Principles Definition with Citation Standards"
        - "Initial Research Execution with Source Validation"
        - "Constitutional Self-Evaluation including Citation Integrity Assessment"
        - "Constitutional Correction including Citation Quality Improvement"
        - "Constitutional Validation including Source Verification"
        - "Constitutional Documentation including Citation Methodology"
        
      enhanced_validation_criteria:
        - "All 6 research ethics principles addressed + citation integrity standards defined"
        - "All 6 quality standards applied + source validation requirements included"
        - "Self-evaluation conducted for each principle + citation support verification"
        - "Corrections implemented based on evaluation + citation quality improvements"
        - "Final validation completed + comprehensive source verification"
        - "Compliance report generated + citation methodology documented"
        
      citation_enhanced_compliance_checks:
        principles_defined: false # + citation standards included
        self_evaluation_conducted: false # + source verification included  
        corrections_implemented: false # + citation quality improvements included
        final_validation_completed: false # + source validation completed
        compliance_report_generated: false # + citation methodology documented
        constitutional_score: 0.0  # Overall constitutional compliance score + citation integrity component
        constitutional_citation_integration_score: 0.0 # Specific score for citation integration with constitutional AI
    
    complex_research:
      required_modules: "4-6"  
      expected_structure:
        - "Project Analysis: Objectives and dependencies with source requirements"
        - "Module Creation: 4-6 independent modules with dedicated source validation"
        - "Sequencing Logic: Execution order with citation dependency tracking"
        - "Individual Module Prompts: Specific prompts with source validation requirements"
        - "Final Integration Prompt: Synthesis approach with comprehensive citation validation"
        
      enhanced_validation_criteria:
        - "Clear module boundaries and objectives include source validation scope"
        - "Modules can be researched separately with independent source verification"
        - "Logical connections between modules include source consistency validation"
        - "Manageable scope per module includes feasible source validation requirements"
        - "Integration strategy defined includes cross-module citation synthesis approach"
        
      citation_enhanced_compliance_checks:
        modules_created: 0  # Number of modules actually created + citation tracking implemented
        module_independence: false  # Whether modules can be researched separately + source validation independence
        clear_boundaries: false  # Whether module scope is well-defined + source validation scope included
        integration_strategy: false  # Whether synthesis approach is specified + citation methodology included
        complex_research_citation_compliance: 0.0 # Overall citation compliance across all modules
  
  # ENHANCED OVERALL COMPLIANCE WITH CITATION INTEGRATION
  overall_compliance:
    method_prompt_followed: false  # Whether the method prompt structure was followed
    expected_outputs_generated: false  # Whether all expected outputs were created
    validation_criteria_met: 0.0  # Percentage of validation criteria satisfied
    compliance_score: 0.0  # Overall compliance score (0-1)
    
    # NEW: Citation compliance integration
    citation_requirements_met: false # Whether citation requirements were satisfied
    citation_validation_criteria_satisfied: 0.0 # Percentage of citation validation criteria met
    citation_compliance_score: 0.0 # Overall citation compliance score (0-1)
    integrated_compliance_score: 0.0 # Combined method + citation compliance score (0-1)
    
  # ENHANCED ISSUES AND RECOMMENDATIONS
  compliance_issues:
    - issue_type: "missing_output|incorrect_structure|insufficient_detail|citation_failure|source_verification_failure"
      issue_description: "description_of_compliance_issue"
      severity: "critical|high|medium|low"
      recommendation: "how_to_fix_the_issue"
      citation_related: false # Whether issue is citation-related
      
  # ENHANCED FILE TRACKING WITH CITATION COMPLIANCE
  research_files_generated:
    - file_path: "research/findings/topic/research/filename.md"
      file_type: "perspective|phase|module|main_analysis"
      method_component: "which_part_of_method_this_represents"
      compliance_status: "compliant|non_compliant|partial"
      citation_compliance_status: "citation_compliant|citation_non_compliant|citation_partial" # NEW
      source_validation_completed: false # NEW
      attribution_completeness: 0.0 # NEW: Percentage of content with proper attribution
      
  # ENHANCED QUALITY ASSESSMENT WITH CITATION INTEGRATION
  research_quality_indicators:
    follows_method_structure: false
    contains_required_elements: false  
    appropriate_depth_and_detail: false
    methodology_correctly_applied: false
    integration_quality_satisfactory: false
    
    # NEW: Citation quality indicators
    citation_standards_followed: false # Whether citation standards were properly followed
    source_credibility_adequately_assessed: false # Whether source credibility was properly assessed
    attribution_transparency_maintained: false # Whether attribution was transparent throughout
    source_verification_systematically_conducted: false # Whether source verification was systematic
    conflict_resolution_appropriately_handled: false # Whether source conflicts were properly resolved
    
  # ENHANCED VALIDATION METADATA WITH CITATION TRACKING
  validation_metadata:
    validator_version: "1.0.0"
    citation_integration_version: "1.0.0" # NEW
    validation_completeness: 1.0
    validation_confidence: 0.0
    validation_notes: "additional_observations_about_compliance"
    
    # NEW: Citation validation metadata
    citation_validation_completeness: 0.0 # Completeness of citation validation
    citation_validation_confidence: 0.0 # Confidence in citation validation results
    source_verification_coverage: 0.0 # Percentage of sources that underwent verification  
    credibility_assessment_coverage: 0.0 # Percentage of sources with credibility assessment
    citation_validation_notes: "additional_observations_about_citation_compliance" # NEW

# CITATION COMPLIANCE SCORING ALGORITHM
citation_compliance_scoring:
  scoring_components:
    source_verification_weight: 0.25 # 25% weight for source verification accuracy
    citation_format_weight: 0.15 # 15% weight for citation format compliance
    attribution_completeness_weight: 0.20 # 20% weight for attribution completeness
    credibility_assessment_weight: 0.20 # 20% weight for credibility assessment coverage
    conflict_resolution_weight: 0.10 # 10% weight for conflict resolution effectiveness
    constitutional_integration_weight: 0.10 # 10% weight for constitutional AI integration
    
  calculation_formula: |
    citation_compliance_score = (
      source_verification_accuracy * 0.25 +
      citation_format_compliance * 0.15 +
      attribution_completeness * 0.20 +
      credibility_assessment_coverage * 0.20 +
      conflict_resolution_effectiveness * 0.10 +
      constitutional_citation_integration_score * 0.10
    )
    
  integrated_compliance_calculation: |
    integrated_compliance_score = (
      compliance_score * 0.60 +
      citation_compliance_score * 0.40
    )
    
  performance_thresholds:
    excellent_citation_compliance: "≥0.95 - Exceptional citation integrity"
    good_citation_compliance: "0.85-0.94 - Good citation standards with minor improvements needed"
    acceptable_citation_compliance: "0.75-0.84 - Acceptable citation quality requiring some enhancement"
    needs_improvement_citation_compliance: "0.60-0.74 - Citation compliance needs significant improvement"
    inadequate_citation_compliance: "<0.60 - Citation compliance inadequate, requires major revision"

# REAL-TIME MONITORING INTEGRATION
real_time_citation_monitoring:
  monitoring_checkpoints:
    research_initiation: "Validate citation requirements and source discovery approach"
    25_percent_completion: "Assess source verification progress and credibility assessment coverage"
    50_percent_completion: "Validate source diversity, independence, and conflict detection"
    75_percent_completion: "Verify attribution completeness and citation format compliance"
    pre_synthesis: "Final citation validation before synthesis phase"
    post_completion: "Comprehensive citation compliance assessment"
    
  intervention_triggers:
    citation_compliance_below_75_percent: "Immediate attention required for citation compliance"
    source_verification_failure_rate_above_10_percent: "Review source verification methodology"
    credibility_assessment_coverage_below_85_percent: "Enhance credibility assessment coverage"
    attribution_gaps_detected: "Address attribution completeness issues"
    format_compliance_below_95_percent: "Standardize citation format compliance"
    
  automated_quality_gates:
    minimum_citation_compliance_gate: "Research cannot proceed with <60% citation compliance"
    source_verification_gate: "Research paused if source verification accuracy <80%"
    attribution_completeness_gate: "Synthesis blocked if attribution completeness <90%"
    conflict_resolution_gate: "Final validation blocked if major conflicts unresolved"
EOF < /dev/null